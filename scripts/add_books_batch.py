"""
μΌκ΄„ μ±… λ©λ΅ μ¶”κ°€ μ¤ν¬λ¦½νΈ
μ•λ ¤μ§„ λ…μ‘ λ° λ€ν•™ μ¶”μ² λ„μ„λ¥Ό μΌκ΄„ μ¶”κ°€ν•©λ‹λ‹¤.
"""

import csv
from pathlib import Path

# λ…μ‘ λ„μ„ λ¦¬μ¤νΈ
masterpieces = [
    ("1984", "μ΅°μ§€ μ¤μ›°", "μ„Έκ³„λ¬Έν•™"),
    ("λ™λ¬Όλ†μ¥", "μ΅°μ§€ μ¤μ›°", "μ„Έκ³„λ¬Έν•™"),
    ("λ…ΈμΈκ³Ό λ°”λ‹¤", "μ–΄λ‹μ¤νΈ ν—¤λ°μ›¨μ΄", "λ…Έλ²¨λ¬Έν•™μƒ"),
    ("ν–„λ¦Ώ", "μλ¦¬μ—„ μ…°μµμ¤ν”Όμ–΄", "μ„Έκ³„λ¬Έν•™"),
    ("λ΅λ―Έμ¤μ™€ μ¤„λ¦¬μ—£", "μλ¦¬μ—„ μ…°μµμ¤ν”Όμ–΄", "μ„Έκ³„λ¬Έν•™"),
    ("μ£„μ™€ λ²", "λ„μ¤ν† μ™μ¤ν‚¤", "λ¬μ‹μ•„λ¬Έν•™"),
    ("μ „μκ³Ό ν‰ν™”", "ν†¨μ¤ν† μ΄", "λ¬μ‹μ•„λ¬Έν•™"),
    ("μ•λ‚ μΉ΄λ λ‹λ‚", "ν†¨μ¤ν† μ΄", "λ¬μ‹μ•„λ¬Έν•™"),
    ("μ„λ€ν• κ°μΈ λΉ„", "F. μ¤μ½§ ν”ΌμΈ μ λ΄λ“", "λ―Έκµ­λ¬Έν•™"),
    ("ν†° μ†μ—¬μ λ¨ν—", "λ§ν¬ νΈμ›¨μΈ", "λ―Έκµ­λ¬Έν•™"),
    ("ν—ν΄λ² λ¦¬ ν•€μ λ¨ν—", "λ§ν¬ νΈμ›¨μΈ", "λ―Έκµ­λ¬Έν•™"),
    ("λ  λ―Έμ λΌλΈ”", "λΉ…ν† λ¥΄ μ„κ³ ", "ν”„λ‘μ¤λ¬Έν•™"),
    ("λ¬ν…ν¬λ¦¬μ¤ν†  λ°±μ‘", "μ•λ ‰μƒλ“λ¥΄ λ’¤λ§", "ν”„λ‘μ¤λ¬Έν•™"),
    ("μ‚Όκµ­μ§€", "λ‚κ΄€μ¤‘", "μ¤‘κµ­λ¬Έν•™"),
    ("μνΈμ§€", "μ‹λ‚΄μ•”", "μ¤‘κµ­λ¬Έν•™"),
    ("λν‚¤νΈν…", "λ―Έκ²” λ° μ„Έλ¥΄λ°ν…μ¤", "μ¤νμΈλ¬Έν•™"),
    ("μ¤λ§κ³Ό νΈκ²¬", "μ μΈ μ¤μ¤ν‹΄", "μκµ­λ¬Έν•™"),
    ("μ μΈ μ—μ–΄", "μƒ¬λ΅― λΈλ΅ ν…", "μκµ­λ¬Έν•™"),
    ("ν­ν’μ μ–Έλ•", "μ—λ°€λ¦¬ λΈλ΅ ν…", "μκµ­λ¬Έν•™"),
    ("λ°μ΄λΉ„λ“ μ½”νΌν•„λ“", "μ°°μ¤ λ””ν‚¨μ¤", "μκµ­λ¬Έν•™"),
    ("λ‘ λ„μ‹ μ΄μ•ΌκΈ°", "μ°°μ¤ λ””ν‚¨μ¤", "μκµ­λ¬Έν•™"),
    ("ν”„λ‘μΌ„μνƒ€μΈ", "λ©”λ¦¬ μ…Έλ¦¬", "μκµ­λ¬Έν•™"),
    ("λ¨λΉ„λ”•", "ν—λ¨Ό λ©λΉ", "λ―Έκµ­λ¬Έν•™"),
    ("λ°±κ²½", "ν—λ¨Ό λ©λΉ", "λ―Έκµ­λ¬Έν•™"),
    ("μ κ³Ό ν‘", "μ¤νƒ•λ‹¬", "ν”„λ‘μ¤λ¬Έν•™"),
    ("λ§λ‹΄ λ³΄λ°”λ¦¬", "κ·€μ¤νƒ€λΈ ν”λ΅λ² λ¥΄", "ν”„λ‘μ¤λ¬Έν•™"),
    ("μ μ€ λ² λ¥΄ν…λ¥΄μ μ¬ν””", "κ΄΄ν…", "λ…μΌλ¬Έν•™"),
    ("νμ°μ¤νΈ", "κ΄΄ν…", "λ…μΌλ¬Έν•™"),
    ("λ³€μ‹ ", "μΉ΄ν”„μΉ΄", "λ…μΌλ¬Έν•™"),
    ("μ„±", "μΉ΄ν”„μΉ΄", "λ…μΌλ¬Έν•™"),
    ("νλ¦¬μ λ…ΈνΈλ¥΄λ‹΄", "λΉ…ν† λ¥΄ μ„κ³ ", "ν”„λ‘μ¤λ¬Έν•™"),
    ("κ·Έλ¦¬μ¤μΈ μ΅°λ¥΄λ°”", "λ‹μ½”μ¤ μΉ΄μ”μ°¨ν‚¤μ¤", "κ·Έλ¦¬μ¤λ¬Έν•™"),
    ("λ°λ―Έμ•", "ν—¤λ¥΄λ§ ν—¤μ„Έ", "λ…μΌλ¬Έν•™"),
    ("μ‹―λ‹¤λ¥΄νƒ€", "ν—¤λ¥΄λ§ ν—¤μ„Έ", "λ…μΌλ¬Έν•™"),
    ("μ λ¦¬μ• μ ν¬", "ν—¤λ¥΄λ§ ν—¤μ„Έ", "λ…Έλ²¨λ¬Έν•™μƒ"),
    ("λ°±λ…„μ κ³ λ…", "κ°€λΈλ¦¬μ— κ°€λ¥΄μ‹μ•„ λ§λ¥΄μΌ€μ¤", "λ…Έλ²¨λ¬Έν•™μƒ"),
    ("νΈλ°€λ°­μ νμκΎΌ", "J.D. μƒλ¦°μ €", "λ―Έκµ­λ¬Έν•™"),
    ("μ•µλ¬΄μƒ μ£½μ΄κΈ°", "ν•νΌ λ¦¬", "λ―Έκµ­λ¬Έν•™"),
    ("λ¶„λ…Έμ ν¬λ„", "μ΅΄ μ¤νƒ€μΈλ²΅", "λ…Έλ²¨λ¬Έν•™μƒ"),
    ("λ™λ¬Όλ†μ¥", "μ΅°μ§€ μ¤μ›°", "μ„Έκ³„λ¬Έν•™"),
    ("νλ¦¬μ μ•„ννΈ", "μ¤„λ¦¬μ–Έ λ°μ¤", "μκµ­λ¬Έν•™"),
    ("λ…Έλ¥΄μ›¨μ΄μ μ²", "λ¬΄λΌμΉ΄λ―Έ ν•λ£¨ν‚¤", "μΌλ³Έλ¬Έν•™"),
    ("1Q84", "λ¬΄λΌμΉ΄λ―Έ ν•λ£¨ν‚¤", "μΌλ³Έλ¬Έν•™"),
    ("ν•΄λ³€μ μΉ΄ν”„μΉ΄", "λ¬΄λΌμΉ΄λ―Έ ν•λ£¨ν‚¤", "μΌλ³Έλ¬Έν•™"),
    ("μ¶ν–¥μ „", "μ‘μλ―Έμƒ", "ν•κµ­λ¬Έν•™"),
    ("ν™κΈΈλ™μ „", "ν—κ· ", "ν•κµ­λ¬Έν•™"),
    ("κµ¬μ΄λ½", "κΉ€λ§μ¤‘", "ν•κµ­λ¬Έν•™"),
    ("μ‚¬μ”¨λ‚¨μ •κΈ°", "κΉ€λ§μ¤‘", "ν•κµ­λ¬Έν•™"),
    ("ν† μ§€", "λ°•κ²½λ¦¬", "ν•κµ­λ¬Έν•™"),
    ("νƒλ°±μ‚°λ§¥", "μ΅°μ •λ", "ν•κµ­λ¬Έν•™"),
    ("μ•„λ¦¬λ‘", "μ΅°μ •λ", "ν•κµ­λ¬Έν•™"),
    ("μ„κΊ½μ •", "κΉ€λ™μΈ", "ν•κµ­λ¬Έν•™"),
    ("μƒλ΅μ", "μ‹¬ν›", "ν•κµ­λ¬Έν•™"),
    ("λ¬΄μ •", "μ΄κ΄‘μ", "ν•κµ­λ¬Έν•™"),
    ("μ‚Όλ€", "μ—Όμƒμ„­", "ν•κµ­λ¬Έν•™"),
    ("νƒν‰μ²ν•", "μ±„λ§μ‹", "ν•κµ­λ¬Έν•™"),
    ("λ‚ κ°", "μ΄μƒ", "ν•κµ­λ¬Έν•™"),
    ("κ΄‘μ¥", "μµμΈν›", "ν•κµ­λ¬Έν•™"),
    ("μ„μΈ 1964λ…„ κ²¨μΈ", "κΉ€μΉμ¥", "ν•κµ­λ¬Έν•™"),
    ("λ¬΄μ§„κΈ°ν–‰", "κΉ€μΉμ¥", "ν•κµ­λ¬Έν•™"),
    ("μ—„λ§λ¥Ό λ¶€νƒν•΄", "μ‹ κ²½μ™", "ν•κµ­λ¬Έν•™"),
    ("μ™Έλ”΄λ°©", "μ€ν¬κ²½", "ν•κµ­λ¬Έν•™"),
    ("μ±„μ‹μ£Όμμ", "ν•κ°•", "ν•κµ­λ¬Έν•™"),
    ("μ†λ…„μ΄ μ¨λ‹¤", "ν•κ°•", "ν•κµ­λ¬Έν•™"),
]

# λ€ν•™ μ¶”μ² λ„μ„ (μΌλ°μ μΌλ΅ μ¶”μ²λλ” μ±…λ“¤)
university_books = [
    ("μ„μΈλ€ ν•„λ…μ„ 100μ„ ", "λ‹¤μ–‘ν• μ €μ", "μ„μΈλ€"),
    ("ν•λ²„λ“ μ¶”μ² λ„μ„", "λ‹¤μ–‘ν• μ €μ", "ν•λ²„λ“"),
    ("μ—°μ„Έλ€ μ¶”μ² λ„μ„", "λ‹¤μ–‘ν• μ €μ", "μ—°μ„Έλ€"),
    ("κ³ λ ¤λ€ μ¶”μ² λ„μ„", "λ‹¤μ–‘ν• μ €μ", "κ³ λ ¤λ€"),
    ("μ„κ°•λ€ μ¶”μ² λ„μ„", "λ‹¤μ–‘ν• μ €μ", "μ„κ°•λ€"),
    ("μ΄ν™”μ—¬λ€ μ¶”μ² λ„μ„", "λ‹¤μ–‘ν• μ €μ", "μ΄ν™”μ—¬λ€"),
    ("ν•κµ­μ‚¬", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("μ„μ–‘μ‚¬", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("λ™μ–‘μ‚¬", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("μ² ν•™μ μ΄ν•΄", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("λ¬Έν•™μ μ΄ν•΄", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("μμ μ μ΄ν•΄", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("κ³Όν•™μ μ΄ν•΄", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("κ²½μ ν•™ μ›λ΅ ", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("μ‹¬λ¦¬ν•™ κ°λ΅ ", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("μ‚¬νν•™ κ°λ΅ ", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("μ •μΉν•™ κ°λ΅ ", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
    ("λ²•ν•™ κ°λ΅ ", "λ‹¤μ–‘ν• μ €μ", "λ€ν•™ κµμ–‘"),
]

def add_books_to_csv(csv_path: str):
    """CSV νμΌμ— μ±… λ©λ΅ μ¶”κ°€"""
    # κΈ°μ΅΄ μ±… λ©λ΅ λ΅λ“
    existing_books = []
    existing_titles = set()
    
    if Path(csv_path).exists():
        with open(csv_path, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            for row in reader:
                existing_books.append(row)
                existing_titles.add(row.get('title', '').strip())
    
    # λ…μ‘ μ¶”κ°€
    added_count = 0
    for title, author, source in masterpieces:
        if title not in existing_titles:
            existing_books.append({
                'title': title,
                'author': author,
                'category': 'masterpiece',
                'season': '',
                'episode': '',
                'source': source,
                'status': 'not_processed',
                'video_created': '',
                'youtube_uploaded': '',
                'notes': '',
                'added_at': ''
            })
            existing_titles.add(title)
            added_count += 1
    
    # λ€ν•™ μ¶”μ² λ„μ„ μ¶”κ°€
    for title, author, source in university_books:
        if title not in existing_titles:
            existing_books.append({
                'title': title,
                'author': author,
                'category': 'university',
                'season': '',
                'episode': '',
                'source': source,
                'status': 'not_processed',
                'video_created': '',
                'youtube_uploaded': '',
                'notes': '',
                'added_at': ''
            })
            existing_titles.add(title)
            added_count += 1
    
    # CSV μ €μ¥
    fieldnames = ['title', 'author', 'category', 'season', 'episode', 
                 'source', 'status', 'video_created', 'youtube_uploaded', 
                 'notes', 'added_at']
    
    with open(csv_path, 'w', encoding='utf-8', newline='') as f:
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        writer.writeheader()
        for book in existing_books:
            writer.writerow(book)
    
    print(f"β… {added_count}κ¶μ μ±…μ΄ μ¶”κ°€λμ—μµλ‹λ‹¤.")
    print(f"   μ΄ {len(existing_books)}κ¶μ μ±…μ΄ λ“±λ΅λμ–΄ μμµλ‹λ‹¤.")
    
    # μΉ΄ν…κ³ λ¦¬λ³„ ν†µκ³„
    categories = {}
    for book in existing_books:
        cat = book.get('category', 'ildangbaek')
        categories[cat] = categories.get(cat, 0) + 1
    
    print("\nπ“ μΉ΄ν…κ³ λ¦¬λ³„ ν†µκ³„:")
    for cat, count in categories.items():
        cat_name = {
            'ildangbaek': 'π“» μΌλ‹Ήλ°± νμΊμ¤νΈ',
            'masterpiece': 'π“ λ…μ‘',
            'university': 'π“ λ€ν•™ μ¶”μ² λ„μ„'
        }.get(cat, cat)
        print(f"  {cat_name}: {count}κ¶")

if __name__ == "__main__":
    csv_path = "assets/ildangbaek_books.csv"
    add_books_to_csv(csv_path)

