#!/usr/bin/env python3
"""
The Sixth Extinction ì´í›„ ì—…ë¡œë“œëœ ëª¨ë“  ì˜ìƒì˜ ë©”íƒ€ë°ì´í„° ì¬ìƒì„± ë° ë³µì‚¬-ë¶™ì—¬ë„£ê¸° íŒŒì¼ ìƒì„±
"""

import subprocess
import sys
from pathlib import Path

# The Sixth Extinction ì´í›„ ì—…ë¡œë“œëœ ì˜ìƒ ëª©ë¡
BOOKS_AFTER = [
    ("í”„ë‘ì¼„ìŠˆíƒ€ì¸", "ë©”ë¦¬ ì…¸ë¦¬"),
    ("ì Šì€ ë² ë¥´í…Œë¥´ì˜ ìŠ¬í””", "ê´´í…Œ"),
    ("í–‰ë™í•˜ì§€ ì•Šìœ¼ë©´ ì¸ìƒì€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤", "ë¸Œë¼ì´ì–¸ íŠ¸ë ˆì´ì‹œ"),
    ("ì„¤êµ­", "ê°€ì™€ë°”íƒ€ ì•¼ìŠ¤ë‚˜ë¦¬"),
    ("ë¶€ì ì•„ë¹  ê°€ë‚œí•œ ì•„ë¹ ", "ë¡œë²„íŠ¸ ê¸°ìš”ì‚¬í‚¤"),
    ("í˜„ëª…í•œ íˆ¬ìì", "ë²¤ì €ë¯¼ ê·¸ë ˆì´ì—„"),
    ("ê´´ë¸, ì—ì…”, ë°”í", "ë”ê¸€ëŸ¬ìŠ¤ í˜¸í”„ìŠ¤íƒœí„°"),
    ("ì€í•˜ìˆ˜ë¥¼ ì—¬í–‰í•˜ëŠ” íˆì¹˜í•˜ì´ì»¤ë¥¼ ìœ„í•œ ì•ˆë‚´ì„œ", "ë”ê¸€ë¼ìŠ¤ ì• ë¤ìŠ¤"),
    ("íŒ©íŠ¸í’€ë‹ˆìŠ¤", "í•œìŠ¤ ë¡œìŠ¬ë§"),
    ("ì—ì„¼ì…œë¦¬ì¦˜", "ê·¸ë ‰ ë§¥ì»¤ìš´"),
    ("21ì„¸ê¸° ìë³¸", "í† ë§ˆ í”¼ì¼€í‹°"),
    ("ìœ ì „ì", "ì‹œë‹¤ë¥´íƒ€ ë¬´ì¼€ë¥´ì§€"),
    ("í˜¸ë‘ê¹Œê¸° ì¸í˜•", "E.T.A. í˜¸í”„ë§Œ"),
    ("ìŠ¤ë…¸ìš°ë§¨", "ë ˆì´ë¨¼ë“œ ë¸Œë¦­ìŠ¤"),
    ("í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì„ ë¬¼", "ì˜¤ í—¨ë¦¬"),
    ("ë‚˜ëŠ” ì˜¤ëŠ˜ë„ ê²½ì œì  ììœ ë¥¼ ê¿ˆê¾¼ë‹¤", "ëŒë¦¿ ì„¸í‹°"),
    ("ì¼ë¡  ë¨¸ìŠ¤í¬", "ì›”í„° ì•„ì´ì‘ìŠ¨"),
    ("ë¶€ì— ëŒ€í•œ ì—°ê°", "ë‚˜ë°œ ë¼ë¹„ì¹¸íŠ¸"),
    ("ë¶€ì˜ ì¶”ì›”ì°¨ì„ ", "ì— ì œì´ ë“œë§ˆì½”"),
    ("ì‹ ê²½ ë„ê¸°ì˜ ê¸°ìˆ ", "ë§ˆí¬ ë§¨ìŠ¨"),
    ("ë‚¨ì•„ ìˆëŠ” ë‚˜ë‚ ", "ì¹´ì¦ˆì˜¤ ì´ì‹œêµ¬ë¡œ"),
    ("ì¸ê°„ì˜ ìœ„ëŒ€í•œ ì—¬ì •", "ì—ë¦­ ì—ë¦­ìŠ¨"),
    ("ìƒê°ì— ê´€í•œ ìƒê°", "ëŒ€ë‹ˆì–¼ ì¹´ë„ˆë¨¼"),
    ("ëª…ìƒë¡", "ë§ˆë¥´ì¿ ìŠ¤ ì•„ìš°ë ë¦¬ìš°ìŠ¤"),
    ("ëœë¤ì›Œí¬ì— ì†ì§€ ë§ˆë¼", "ë‚˜ì‹¬ íƒˆë ˆë¸Œ"),
]


def regenerate_metadata(book_title: str, author: str) -> bool:
    """ë©”íƒ€ë°ì´í„° ì¬ìƒì„±"""
    try:
        cmd = [
            sys.executable,
            "src/08_create_and_preview_videos.py",
            "--book-title", book_title,
            "--author", author,
            "--metadata-only"
        ]
        result = subprocess.run(cmd, capture_output=True, text=True, encoding='utf-8')
        if result.returncode == 0:
            return True
        else:
            print(f"   âŒ ì˜¤ë¥˜: {result.stderr[:200]}")
            return False
    except Exception as e:
        print(f"   âŒ ì˜ˆì™¸ ë°œìƒ: {e}")
        return False


def main():
    """ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜"""
    print("=" * 80)
    print("ğŸ“‹ The Sixth Extinction ì´í›„ ì˜ìƒ ë©”íƒ€ë°ì´í„° ì¬ìƒì„±")
    print("=" * 80)
    print()
    
    success_count = 0
    for book_title, author in BOOKS_AFTER:
        print(f"ğŸ“š {book_title} ({author})")
        print(f"   ë©”íƒ€ë°ì´í„° ì¬ìƒì„± ì¤‘...")
        
        if regenerate_metadata(book_title, author):
            success_count += 1
            print(f"   âœ… ì™„ë£Œ")
        else:
            print(f"   âŒ ì‹¤íŒ¨")
        print()
    
    print("=" * 80)
    print(f"âœ… ë©”íƒ€ë°ì´í„° ì¬ìƒì„± ì™„ë£Œ: {success_count}/{len(BOOKS_AFTER)}ê°œ")
    print("=" * 80)
    print()
    print("ë‹¤ìŒ ë‹¨ê³„: ë³µì‚¬-ë¶™ì—¬ë„£ê¸°ìš© txt íŒŒì¼ ìƒì„±")
    print("python scripts/generate_copy_paste_metadata.py")


if __name__ == "__main__":
    main()

