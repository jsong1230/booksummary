# BookReview-AutoMaker 프로젝트 히스토리

## 2025-12-01

### NotebookLM 비디오 통합 기능 추가
- **영상 구성 변경**: Summary → NotebookLM Video → Audio 순서로 영상 생성
  - Summary 부분: 요약 오디오 + 이미지 슬라이드쇼
  - NotebookLM Video 부분: NotebookLM에서 생성한 비디오 자동 삽입
  - Audio 부분: 리뷰 오디오 + 이미지 슬라이드쇼
- **NotebookLM 비디오 자동 검색 기능**:
  - `assets/video/` 폴더에서 자동으로 비디오 파일 검색
  - 파일명 기반 언어 자동 감지 (한글 파일명 → 한글 비디오, 영문 파일명 → 영어 비디오)
  - 명시적 언어 표시 (`_ko`, `_en`) 우선 인식
- **코드 변경사항**:
  - `src/03_make_video.py`: `create_video` 메서드에 `notebooklm_video_path` 파라미터 추가
  - `src/10_create_video_with_summary.py`: NotebookLM 비디오 자동 검색 및 전달 로직 추가
  - `--notebooklm-video` CLI 옵션 추가
- **폴더 구조**:
  - `assets/video/` 폴더 생성 (NotebookLM 비디오 저장용)
- **문서 업데이트**:
  - README.md에 NotebookLM 비디오 사용법 추가

## 2024-11-23

### 초기 프로젝트 설정
- 프로젝트 디렉토리 구조 생성
- Phase 1: 자료 수집 자동화 코드 작성
  - `01_search_urls.py`: 책 관련 URL 수집 스크립트
    - 위키백과, 온라인 서점, 뉴스 리뷰 타겟 검색
    - NotebookLM용 텍스트 파일 출력
    - CSV/JSON 파일로 일괄 처리 지원
  - `02_get_images.py`: 이미지 다운로드 스크립트
    - Google Books API로 책 표지 다운로드
    - Pexels/Unsplash API로 무드 이미지 다운로드 (5~10장)
    - assets/images/{책제목}/ 폴더에 정리

### 환경 설정
- requirements.txt 작성
- .env 파일 설정 (모든 API 키 포함)
- 가상환경 설정 스크립트 작성
- 실행 스크립트 작성 (가상환경 자동 활성화)

### API 키 설정
- GOOGLE_BOOKS_API_KEY: 설정 완료
- PEXELS_API_KEY: 설정 완료
- UNSPLASH_ACCESS_KEY: 설정 완료
- OPENAI_API_KEY: 설정 완료
- CLAUDE_API_KEY: 설정 완료

### 패키지 설치
- python-dotenv, requests, beautifulsoup4, lxml
- googlesearch-python
- google-api-python-client
- pexels-api
- moviepy, pydub (Phase 4용)

### 프로젝트 문서화
- README.md 작성 (설치 방법, 사용법, API 키 발급 방법)
- TODO 파일 생성
- HISTORY 파일 생성
- RULES 파일 생성 (예정)

### Git 설정
- .gitignore 설정
- 자동 커밋/푸시 스크립트 작성

## 다음 작업
- Phase 4: 영상 합성 및 편집 기능 구현
- 테스트 및 버그 수정


## 2025-11-23

### YouTube 업로드 완료
- 업로드된 책: 노르웨이의_숲
- 업로드된 영상 수: 2개
- [1] [English] Norwegian Wood Book Review | [영어] 노르웨이의 숲 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=6L2zcTHfMXg
- [2] [한국어] 노르웨이의 숲 책 리뷰 | [Korean] Norwegian Wood Book Review | 일당백 스타일
  - URL: https://www.youtube.com/watch?v=w4D-PVE3Aa0

## 2025-11-24

### 영상 생성 최적화
- **줌인/줌아웃 효과 제거**: 정적 이미지 + 페이드 전환만 사용하도록 변경
- **비트레이트 조정**: 1500k로 낮춰서 정적 이미지 영상에 최적화
- **MoviePy API 수정**: `resized` → `resize` 메서드 변경 (호환성 개선)
- **파일 크기 최적화**: 15.7분 영상 기준 약 172MB (이전 725MB에서 대폭 감소)

### 1984 영상 생성 진행 중
- **한글 영상**: ✅ 완료
  - 파일: `output/1984_review_ko.mp4`
  - 크기: 183MB
  - 길이: 15.7분 (940초)
  - 생성 시간: 2025-11-24 00:38
  - 이미지: 21개 (cover 1개 + mood 20개)
  - 설정: 정적 이미지 + 페이드 전환, 비트레이트 1500k
- **영문 영상**: ⏳ 대기 중 (영문 오디오 파일 필요)
- **썸네일**: ⏳ 대기 중
- **메타데이터**: ⏳ 대기 중

### URL 수집 배치 작업 진행 중
- **백그라운드 프로세스**: 실행 중 (PID: 78980)
- **진행률**: 59% (167/283개 완료)
- **총 항목**: 283개
  - 책: 83개 (노르웨이의 숲 제외)
  - 주제: 200개
- **생성된 파일**: 167개 MD 파일 (`assets/urls/` 폴더)
- **최근 생성**: 2025-11-24 08:50 (프리랜서_경제Gig_Economy의_구조_notebooklm.md)
- **예상 완료 시간**: 약 40-50분 후 (남은 116개 항목)

### 노르웨이의 숲 관련 파일 삭제
- 오디오 파일 삭제
- 이미지 파일 삭제 (20개)
- URL MD 파일 삭제
- CSV에서 제외

### 코드 개선
- URL 수집 스크립트 개선: DuckDuckGo 검색 + YouTube API 통합
- 배치 URL 수집 스크립트 추가 (`scripts/batch_collect_urls.py`)
- 전체 파이프라인 스크립트 추가 (`src/12_full_pipeline.py`)
- 유틸리티 모듈 추가 (`src/utils/`)
- 썸네일 생성 및 업로드 스크립트 추가 (`src/10_generate_thumbnail.py`, `src/11_upload_thumbnails.py`)

### Git 커밋
- 커밋 해시: `5d4ac07`
- 메시지: "feat: 영상 생성 최적화 - 줌인 효과 제거 및 비트레이트 조정"
- 변경: 47개 파일, 3,864줄 추가, 248줄 삭제

## 2024-11-24 (후반)

### 요약 및 TTS 기능 추가 ✅
- **AI 기반 책 요약 생성** (`src/08_generate_summary.py`)
  - Claude API 또는 OpenAI API 사용
  - 한글/영문 지원
  - 인트로/아웃트로 자동 추가
  - 한글 존댓말 강제 적용
  - 최소 단어 수 보장 로직

- **TTS 음성 생성** (`src/09_text_to_speech.py`)
  - OpenAI TTS API 사용
  - 한글: 'nova' 음성 (자연스러운 여성 음성)
  - 영어: 'alloy' 음성
  - 긴 텍스트 자동 분할 (4096자 제한 대응)
  - 문장 단위 분할 및 오디오 병합

- **요약 포함 영상 제작** (`src/10_create_video_with_summary.py`)
  - 요약 오디오와 리뷰 오디오 자동 연결
  - 3초 간격 추가 (자연스러운 전환)
  - 페이드 인/아웃 효과

### 영상 생성 개선 ✅
- **이미지 순환 반복**: 최대 100개 이미지를 영상 길이에 맞춰 순환 반복
- **페이드 전환**: fade in/out 효과로 자연스러운 전환
- **오디오 연결**: 요약 오디오 + 3초 간격 + 리뷰 오디오

### 썸네일 생성 기능 ✅
- **자동 썸네일 생성** (`src/10_generate_thumbnail.py`)
  - 책 제목, 작가 정보 포함
  - 한글/영문 버전 지원
  - DALL-E 배경 이미지 옵션
  - YouTube 권장 크기 (1280x720)
  - 그라데이션 배경 지원

### 1984 영상 생성 완료
- **한글 영상**: ✅ 완료
  - 파일: `output/1984_review_with_summary_ko.mp4`
  - 크기: 232MB
  - 길이: 19분 53초
  - 구성: 요약 (2.8분) + 3초 간격 + 리뷰 (17분)
  - 이미지: 100개 순환 반복
  - 썸네일: `output/1984_thumbnail_ko.jpg` (201K)

- **영어 영상**: ⚠️ 요약 미포함 (나중에 재생성 예정)
  - 파일: `output/1984_review_with_summary_en.mp4`
  - 크기: 454MB
  - 길이: 38분 38초
  - 썸네일: `output/1984_thumbnail_en.jpg` (206K)

### 코드 개선
- 텍스트 분할 로직 개선 (TTS API 제한 대응)
- 오디오 연결 로직 개선 (fade 효과, 간격 추가)
- 이미지 순환 로직 개선 (100개 이미지 순환 반복)
- 인트로/아웃트로 중복 제거 로직 개선
- 메타데이터에 요약/리뷰 정보 포함

### Git 커밋 준비
- README 업데이트 (새로운 기능 추가)
- history 파일 업데이트
- 임시 파일 정리

## 2025-11-25

### YouTube 업로드 완료
- 업로드된 책: 1984_with_summary_en, 1984_with_summary_ko
- 업로드된 영상 수: 2개
- [1] [English] 1984 Book Review | [영어] 1984 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=cRd7BWQV4S8
- [2] [한국어] 1984 책 리뷰 | [Korean] 1984 Book Review | 일당백 스타일
  - URL: https://www.youtube.com/watch?v=_dhn1O7BWNs

## 2025-11-28

### YouTube 업로드 완료
- 업로드된 책: 호밀밭의_파수꾼_with_summary_ko, 호밀밭의_파수꾼_with_summary_en
- 업로드된 영상 수: 2개
- [1] [English] The Catcher in the Rye Book Review | [영어] 호밀밭의 파수꾼 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=Je7tPM-5k-s
- [2] [한국어] 호밀밭의 파수꾼 책 리뷰 | [Korean] The Catcher in the Rye Book Review | 일당백 스타일
  - URL: https://www.youtube.com/watch?v=kxiAn0TW0_s

### 유튜브 채널에서 CSV 자동 업데이트 기능 추가
- **새 스크립트**: `src/13_update_csv_from_youtube.py`
  - 유튜브 채널에 업로드된 책 정보를 자동으로 CSV에 반영
  - YouTube Data API를 사용하여 채널의 모든 비디오 검색
  - 비디오 제목과 책 제목 매칭 (별칭 지원: "노르웨이의 숲" = "상실의 시대")
  - Shorts 비디오 자동 제외
  - `status`, `youtube_uploaded`, `video_created` 필드 자동 업데이트

### 깊이 있는 URL 수집 기능 추가
- **새 스크립트**: `src/14_collect_deep_urls_for_notebooklm.py`
  - 유튜브 롱폼 북튜브를 위한 깊이 있는 자료 수집
  - YouTube 영상(30분 이상) 우선 수집 (전체의 50% 목표)
  - PDF 파일, 논문, 학술 사이트 검색 지원
  - 특정 YouTube 채널 우선순위 검색
    - 최우선: @1DANG100 (일당백)
    - 한글 우선순위: @thewinterbookstore, @chaegiljji, @humanitylearning, @mkkimtv
    - 영어 우선순위: @BTFC, @ClimbtheStacks, @JackEdwards, @arielbissett
  - 학술 사이트: academia.edu, researchgate.net, jstor.org, dbpia.co.kr, kci.go.kr, riss.kr 등
  - 결과 저장: `assets/urls/{책제목}_notebooklm.md` (URL만 저장)

### URL 수집 프롬프트 문서 작성
- **새 문서**: `docs/URL_COLLECTION_PROMPT.md`
  - GPT/Gemini에게 직접 사용할 수 있는 프롬프트 템플릿
  - 검색 쿼리, 검증 규칙, 채널 우선순위 등 상세 가이드 포함
  - 예시 프롬프트 제공

### 프로젝트 규칙 업데이트
- `.cursorrules`에 CSV 업데이트 규칙 추가
  - 커밋 전 필수 작업에 `ildangbaek_books.csv` 업데이트 항목 추가
  - 유튜브 채널 업로드 정보 반영 방법 명시

## 2025-11-29

### YouTube 업로드 완료
- 업로드된 책: Animal_Farm_with_summary_en, 동물농장_with_summary_ko
- 업로드된 영상 수: 2개
- [1] [English] 동물농장 Book Review | [영어] 동물농장 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=VJevqE1i5eY
- [2] [한국어] 동물농장 책 리뷰 | [Korean] 동물농장 Book Review | 일당백 스타일
  - URL: https://www.youtube.com/watch?v=7kKPZNp7Vqc

## 2025-11-30

### YouTube 업로드 완료
- 업로드된 책: 동물농장_with_summary_ko
- 업로드된 영상 수: 1개
- [1] [한국어] 동물농장 책 리뷰 | [Korean] 동물농장 Book Review | 일당백 스타일
  - URL: https://www.youtube.com/watch?v=v3HWKy3I384

## 2025-11-30

### 동물농장 영상 제작 및 업로드
- **한글 영상 재생성**: 요약 오디오 포함 버전으로 재생성
  - 파일: `output/동물농장_review_with_summary_ko.mp4` (219MB, 약 18.7분)
  - 구성: 요약(3.9분) + 3초 간격 + 리뷰(14.8분)
  - YouTube 업로드: https://www.youtube.com/watch?v=v3HWKy3I384

### 햄릿 영상 제작 및 업로드
- **요약 생성**: 한글/영어 요약 텍스트 생성 (MD 파일 기반)
- **TTS 오디오 생성**: 한글(nova), 영어(alloy) 음성 생성
- **이미지 다운로드**: 82개 무드 이미지 수집
- **영상 제작**:
  - 한글: `output/햄릿_review_with_summary_ko.mp4` (205MB, 약 17.5분)
  - 영어: `output/Hamlet_review_with_summary_en.mp4` (188MB, 약 16분)
- **썸네일 생성**: PNG 파일을 썸네일 크기로 리사이즈하여 교체 (2MB 이하로 압축)
- **YouTube 업로드**: 2개 영상 업로드 완료
  - [1] [English] Hamlet Book Review: https://www.youtube.com/watch?v=BcNpf_bYNNI
  - [2] [한국어] 햄릿 책 리뷰: https://www.youtube.com/watch?v=pe4LYzG_2ts

### 태그 생성 기능 개선
- **추천 기관 태그 추가** (`src/08_create_and_preview_videos.py`, `src/05_auto_upload.py`)
  - 세계적/국내기관 및 미디어: 뉴욕타임즈, 아마존, 타임지, CNN, 뉴스위크
  - 주요 서점: 교보문고, 알라딘, YES24
  - 주요 도서관: 국립중앙도서관, 서울도서관
  - 정부기관: 문화체육관광부, 한국출판문화산업진흥원
  - 유명 대학: 서울대학교, 고려대학교, 연세대학교, 하버드대학교, 시카고대학교, 도쿄대학교, 베이징대학교, 미국대학위원회
  - 문학상: 노벨문학상, 퓰리처상, 맨부커상, 공쿠르상, 르노도상
  - 기타: 출판저널, 학교도서관저널, 서평지, 독서운동, 환경책선정위원회
  - 우선순위에 따라 선택적으로 추가 (YouTube 태그 제한 고려)

## 2025-11-30

### 벅아이(Buckeye) 영상 제작 및 업로드 완료
- **책 정보**: Buckeye (Patrick Ryan 저)
- **작업 내용**:
  - 한글 요약 생성 (5분 목표)
  - 요약 TTS 오디오 생성 (한글/영어)
  - 이미지 다운로드 (96개 무드 이미지)
  - 한글/영어 영상 제작 (요약 + 리뷰 오디오)
  - 썸네일 생성 및 PNG 파일로 교체 (2MB 이하 압축)
  - 메타데이터 생성 (한글/영어)
- **YouTube 업로드**:
  - 업로드된 영상 수: 2개
  - [1] [English] Buckeye Book Review | [영어] 벅아이 책 리뷰 | Auto-Generated
    - URL: https://www.youtube.com/watch?v=YTkz7T-r7OU
    - 파일 크기: 161.26 MB
  - [2] [한국어] 벅아이 책 리뷰 | [Korean] Buckeye Book Review | 일당백 스타일
    - URL: https://www.youtube.com/watch?v=0t_VwtyyDN8
    - 파일 크기: 163.62 MB
- **CSV 업데이트**: data/ildangbaek_books.csv에 벅아이 정보 추가

### 메타데이터 생성 로직 개선
- **문제**: 영어 메타데이터의 한글 부분에 영어 제목이 그대로 들어가는 문제
- **해결**: 
  - `translate_book_title_to_korean` 함수에 "Buckeye" → "벅아이" 매핑 추가
  - `translate_book_title` 함수에 "벅아이" → "Buckeye" 매핑 추가
  - `generate_title` 함수에서 번역 실패 시 발음 변환 매핑 사용
  - `src/08_create_and_preview_videos.py`와 `src/05_auto_upload.py` 모두 수정
- **결과**: 
  - 영어 메타데이터: `[English] Buckeye Book Review | [영어] 벅아이 책 리뷰`
  - 한글 메타데이터: `[한국어] 벅아이 책 리뷰 | [Korean] Buckeye Book Review`

## 2025-11-30

### 선라이즈 온 더 리핑(Sunrise on the Reaping) 영상 제작 및 업로드 완료
- **책 정보**: Sunrise on the Reaping (Suzanne Collins 저)
- **작업 내용**:
  - 한글/영어 요약 생성 (5분 목표)
  - 요약 TTS 오디오 생성 (한글/영어)
  - 이미지 다운로드 (100개 무드 이미지)
  - 한글/영어 영상 제작 (요약 + 리뷰 오디오)
  - 썸네일 생성 및 PNG 파일로 교체 (2MB 이하 압축)
  - 메타데이터 생성 (한글/영어)
- **YouTube 업로드**:
  - 업로드된 영상 수: 2개
  - [1] [English] Sunrise on the Reaping Book Review | [영어] 선라이즈 온 더 리핑 책 리뷰 | Auto-Generated
    - URL: https://www.youtube.com/watch?v=YifDjwcQKi8
    - 파일 크기: 194.27 MB
  - [2] [한국어] 선라이즈 온 더 리핑 책 리뷰 | [Korean] Sunrise on the Reaping Book Review | 일당백 스타일
    - URL: https://www.youtube.com/watch?v=QcmWjHj93fA
    - 파일 크기: 174.14 MB
- **CSV 업데이트**: data/ildangbaek_books.csv에 선라이즈 온 더 리핑 정보 추가

## 2025-12-01

### 썸네일 생성 방식 변경
- **변경 사항**: 썸네일을 Nano Banana에서 수동으로 만든 PNG 파일을 기반으로 처리하도록 변경
  - `process_png_thumbnails` 메서드 개선: `_kr`, `_ko`, `_en` 등으로 구분된 PNG 파일 자동 인식
  - `generate_thumbnail` 메서드: 자동 생성 비활성화, 경고 메시지만 출력
  - `08_create_and_preview_videos.py`: PNG 파일 우선 처리, 없으면 경고만 출력
  - 파일명 예시: `{책제목}_kr.png`, `{책제목}_ko.png`, `{책제목}_en.png`

### 메타데이터 제목 형식 변경
- **변경 사항**: 제목에서 불필요한 접미사 제거
  - 한글 제목: `[한국어] 불안 세대 책 리뷰 | [Korean] The Anxious Generation Book Review` (일당백 스타일 제거)
  - 영어 제목: `[English] The Anxious Generation Book Review | [영어] 불안 세대 책 리뷰` (Auto-Generated 제거)
  - `src/08_create_and_preview_videos.py`의 `generate_title` 함수 수정
  - `src/05_auto_upload.py`의 `generate_title` 메서드 수정

### PNG to JPG 변환 스크립트 추가
- **추가 파일**: `convert_png_to_jpg.py`
  - output 폴더의 PNG 파일을 JPG로 변환하여 롱폼 썸네일로 사용 가능하게 함
  - 4K 해상도 (3840x2160)로 리사이즈
  - 2MB 이하로 압축

## 2025-12-01

### YouTube 업로드 완료
- 업로드된 책: 불안_세대_with_summary_en, 불안_세대_with_summary_ko
- 업로드된 영상 수: 2개
- [1] [English] The Anxious Generation Book Review | [영어] 불안 세대 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=YxzRHyImr_Y
- [2] [한국어] 불안 세대 책 리뷰 | [Korean] The Anxious Generation Book Review | 일당백 스타일
  - URL: https://www.youtube.com/watch?v=XU92ENg3eiI

### 썸네일 검색 로직 개선
- **문제**: 썸네일 파일명이 정확히 일치하지 않으면 찾지 못하는 문제
- **해결**: 다양한 파일명 패턴을 지원하도록 검색 로직 개선
  - 책 제목 변형 생성 (공백 제거, 언더스코어 변환 등)
  - 언어 패턴 확장 (`_ko`, `_kr`, `_en` 등 다양한 형식 지원)
  - 다양한 파일명 패턴 시도 (`{책제목}_thumbnail_{lang}.jpg`, `{책제목}_{lang}_thumbnail.jpg` 등)
  - 유사도 매칭 (output 폴더의 모든 썸네일 파일 검색, 책 제목과 유사한 이름 찾기)
  - 최근 파일 우선 선택 (여러 매칭이 있을 경우)
- **수정 파일**: `src/09_upload_from_metadata.py`

### Downloads 폴더 PNG 변환 스크립트 추가
- **추가 파일**: `convert_downloads_png.py`
  - Downloads 폴더의 PNG 파일을 JPG로 변환하여 롱폼 썸네일로 사용 가능하게 함
  - 4K 해상도 (3840x2160)로 리사이즈
  - 2MB 이하로 압축
  - output 폴더로 변환된 파일 저장
  - 언어 선택 기능 (한글/영어/둘 다)

## 2025-12-01

### 영상 구조 개선 및 기능 추가

#### 영상 구조 변경
- **새로운 영상 구조**: Summary → 3초 silence → NotebookLM Video → 3초 silence → Audio
- 각 섹션 사이에 3초 검은 화면(silence) 추가로 자연스러운 전환
- `src/03_make_video.py`의 `create_video` 함수 수정

#### Summary 오디오 음량 조정 기능
- Summary 오디오 음량 조정 기능 추가 (기본값: 1.2배, 20% 증가)
- `--summary-audio-volume` 파라미터로 조정 가능
- `src/03_make_video.py`, `src/10_create_video_with_summary.py` 수정

#### 썸네일 파일 이름 표준화
- 표준 네이밍 규칙 적용: `{책제목}_thumbnail_{lang}.jpg`
- 예시: `Sunrise_on_the_Reaping_thumbnail_ko.jpg`, `Sunrise_on_the_Reaping_thumbnail_en.jpg`

#### 메타데이터 자동 썸네일 경로 찾기
- 메타데이터 생성 시 썸네일 경로를 자동으로 찾아서 포함
- `find_thumbnail_for_video` 함수 추가
- `src/08_create_and_preview_videos.py`의 `save_metadata` 함수 개선

### YouTube 업로드 완료
- 업로드된 책: Sunrise on the Reaping
- 업로드된 영상 수: 2개
- [1] [English] Sunrise on the Reaping Book Review | [영어] 선라이즈 온 더 리핑 책 리뷰
  - URL: https://www.youtube.com/watch?v=fqhQF3uheEg
- [2] [한국어] 선라이즈 온 더 리핑 책 리뷰 | [Korean] Sunrise on the Reaping Book Review
  - URL: https://www.youtube.com/watch?v=vsqgSAgIdC4

### 문서 업데이트
- README.md 업데이트: 영상 구조, 음량 조정 기능, 메타데이터 생성 방법 추가
