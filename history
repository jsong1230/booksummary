# BookReview-AutoMaker 프로젝트 히스토리

## 2024-11-23

### 초기 프로젝트 설정
- 프로젝트 디렉토리 구조 생성
- Phase 1: 자료 수집 자동화 코드 작성
  - `01_search_urls.py`: 책 관련 URL 수집 스크립트
    - 위키백과, 온라인 서점, 뉴스 리뷰 타겟 검색
    - NotebookLM용 텍스트 파일 출력
    - CSV/JSON 파일로 일괄 처리 지원
  - `02_get_images.py`: 이미지 다운로드 스크립트
    - Google Books API로 책 표지 다운로드
    - Pexels/Unsplash API로 무드 이미지 다운로드 (5~10장)
    - assets/images/{책제목}/ 폴더에 정리

### 환경 설정
- requirements.txt 작성
- .env 파일 설정 (모든 API 키 포함)
- 가상환경 설정 스크립트 작성
- 실행 스크립트 작성 (가상환경 자동 활성화)

### API 키 설정
- GOOGLE_BOOKS_API_KEY: 설정 완료
- PEXELS_API_KEY: 설정 완료
- UNSPLASH_ACCESS_KEY: 설정 완료
- OPENAI_API_KEY: 설정 완료
- CLAUDE_API_KEY: 설정 완료

### 패키지 설치
- python-dotenv, requests, beautifulsoup4, lxml
- googlesearch-python
- google-api-python-client
- pexels-api
- moviepy, pydub (Phase 4용)

### 프로젝트 문서화
- README.md 작성 (설치 방법, 사용법, API 키 발급 방법)
- TODO 파일 생성
- HISTORY 파일 생성
- RULES 파일 생성 (예정)

### Git 설정
- .gitignore 설정
- 자동 커밋/푸시 스크립트 작성

## 2025-11-27

### Summary 자동 생성 기능 추가
- **13_complete_pipeline.py 개선**
  - Summary 오디오가 없으면 자동 생성하는 로직 추가
  - 요약 텍스트 생성 → TTS 변환 → 영상 생성 순서로 진행
  - Hook → Summary → Bridge 구조로 요약 생성 (5분 분량)

### 유튜브 롱폼 영상용 요약 템플릿 문서화
- **docs/SUMMARY_TEMPLATE.md 생성**
  - Hook → Summary → Bridge 구조 가이드
  - Hook 스타일 예시 (질문형, 통계, 역설, 감정적 장면)
  - 요약 작성 가이드 및 Bridge 작성 가이드
  - README.md에 템플릿 정보 추가

### 영어 썸네일 폰트 문제 수정
- **src/utils/translations.py 개선**
  - "삼국지연의" → "Romance of the Three Kingdoms" 매핑 추가
  - "나관중" → "Luo Guanzhong" 매핑 추가
  - 영어 썸네일에서 한글이 깨지는 문제 해결

### 코드 개선
- **src/08_generate_summary.py**
  - Hook → Summary → Bridge 구조 프롬프트 추가
  - use_engaging_opening=True 옵션으로 자동 적용
- **src/10_create_video_with_summary.py**
  - 요약 생성 시 use_engaging_opening=True 기본값 적용

### 삼국지연의 영상 생성 완료
- 한글/영어 영상 생성 완료 (Summary 포함)
- 메타데이터 및 썸네일 생성 완료


## 2025-11-23

### YouTube 업로드 완료
- 업로드된 책: 노르웨이의_숲
- 업로드된 영상 수: 2개
- [1] [English] Norwegian Wood Book Review | [영어] 노르웨이의 숲 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=6L2zcTHfMXg
- [2] [한국어] 노르웨이의 숲 책 리뷰 | [Korean] Norwegian Wood Book Review | 일당백 스타일
  - URL: https://www.youtube.com/watch?v=w4D-PVE3Aa0

## 2025-11-24

### 영상 생성 최적화
- **줌인/줌아웃 효과 제거**: 정적 이미지 + 페이드 전환만 사용하도록 변경
- **비트레이트 조정**: 1500k로 낮춰서 정적 이미지 영상에 최적화
- **MoviePy API 수정**: `resized` → `resize` 메서드 변경 (호환성 개선)
- **파일 크기 최적화**: 15.7분 영상 기준 약 172MB (이전 725MB에서 대폭 감소)

### 1984 영상 생성 진행 중
- **한글 영상**: ✅ 완료
  - 파일: `output/1984_review_ko.mp4`
  - 크기: 183MB
  - 길이: 15.7분 (940초)
  - 생성 시간: 2025-11-24 00:38
  - 이미지: 21개 (cover 1개 + mood 20개)
  - 설정: 정적 이미지 + 페이드 전환, 비트레이트 1500k
- **영문 영상**: ⏳ 대기 중 (영문 오디오 파일 필요)
- **썸네일**: ⏳ 대기 중
- **메타데이터**: ⏳ 대기 중

### URL 수집 배치 작업 진행 중
- **백그라운드 프로세스**: 실행 중 (PID: 78980)
- **진행률**: 59% (167/283개 완료)
- **총 항목**: 283개
  - 책: 83개 (노르웨이의 숲 제외)
  - 주제: 200개
- **생성된 파일**: 167개 MD 파일 (`assets/urls/` 폴더)
- **최근 생성**: 2025-11-24 08:50 (프리랜서_경제Gig_Economy의_구조_notebooklm.md)
- **예상 완료 시간**: 약 40-50분 후 (남은 116개 항목)

### 노르웨이의 숲 관련 파일 삭제
- 오디오 파일 삭제
- 이미지 파일 삭제 (20개)
- URL MD 파일 삭제
- CSV에서 제외

### 코드 개선
- URL 수집 스크립트 개선: DuckDuckGo 검색 + YouTube API 통합
- 배치 URL 수집 스크립트 추가 (`scripts/batch_collect_urls.py`)
- 전체 파이프라인 스크립트 추가 (`src/12_full_pipeline.py`)
- 유틸리티 모듈 추가 (`src/utils/`)
- 썸네일 생성 및 업로드 스크립트 추가 (`src/10_generate_thumbnail.py`, `src/11_upload_thumbnails.py`)

### Git 커밋
- 커밋 해시: `5d4ac07`
- 메시지: "feat: 영상 생성 최적화 - 줌인 효과 제거 및 비트레이트 조정"
- 변경: 47개 파일, 3,864줄 추가, 248줄 삭제

## 2024-11-24 (후반)

### 요약 및 TTS 기능 추가 ✅
- **AI 기반 책 요약 생성** (`src/08_generate_summary.py`)
  - Claude API 또는 OpenAI API 사용
  - 한글/영문 지원
  - 인트로/아웃트로 자동 추가
  - 한글 존댓말 강제 적용
  - 최소 단어 수 보장 로직

- **TTS 음성 생성** (`src/09_text_to_speech.py`)
  - OpenAI TTS API 사용
  - 한글: 'nova' 음성 (자연스러운 여성 음성)
  - 영어: 'alloy' 음성
  - 긴 텍스트 자동 분할 (4096자 제한 대응)
  - 문장 단위 분할 및 오디오 병합

- **요약 포함 영상 제작** (`src/10_create_video_with_summary.py`)
  - 요약 오디오와 리뷰 오디오 자동 연결
  - 3초 간격 추가 (자연스러운 전환)
  - 페이드 인/아웃 효과

### 영상 생성 개선 ✅
- **이미지 순환 반복**: 최대 100개 이미지를 영상 길이에 맞춰 순환 반복
- **페이드 전환**: fade in/out 효과로 자연스러운 전환
- **오디오 연결**: 요약 오디오 + 3초 간격 + 리뷰 오디오

### 썸네일 생성 기능 ✅
- **자동 썸네일 생성** (`src/10_generate_thumbnail.py`)
  - 책 제목, 작가 정보 포함
  - 한글/영문 버전 지원
  - DALL-E 배경 이미지 옵션
  - YouTube 권장 크기 (1280x720)
  - 그라데이션 배경 지원

### 1984 영상 생성 완료
- **한글 영상**: ✅ 완료
  - 파일: `output/1984_review_with_summary_ko.mp4`
  - 크기: 232MB
  - 길이: 19분 53초
  - 구성: 요약 (2.8분) + 3초 간격 + 리뷰 (17분)
  - 이미지: 100개 순환 반복
  - 썸네일: `output/1984_thumbnail_ko.jpg` (201K)

- **영어 영상**: ⚠️ 요약 미포함 (나중에 재생성 예정)
  - 파일: `output/1984_review_with_summary_en.mp4`
  - 크기: 454MB
  - 길이: 38분 38초
  - 썸네일: `output/1984_thumbnail_en.jpg` (206K)

### 코드 개선
- 텍스트 분할 로직 개선 (TTS API 제한 대응)
- 오디오 연결 로직 개선 (fade 효과, 간격 추가)
- 이미지 순환 로직 개선 (100개 이미지 순환 반복)
- 인트로/아웃트로 중복 제거 로직 개선
- 메타데이터에 요약/리뷰 정보 포함

### Git 커밋 준비
- README 업데이트 (새로운 기능 추가)
- history 파일 업데이트
- 임시 파일 정리

## 2025-11-25

### 완전 자동화 파이프라인 구축 ✅
- **통합 파이프라인 스크립트** (`src/13_complete_pipeline.py`)
  - Summary/Review 오디오 자동 탐지
  - en/kr 언어별 영상 자동 생성 (summary 포함)
  - en/kr 언어별 메타데이터 자동 생성 및 저장 (title, description, tags)
  - en/kr 언어별 썸네일 자동 생성
  - 한 번의 명령으로 전체 프로세스 자동 실행

- **실행 스크립트** (`run_complete_pipeline.sh`)
  - 간편한 실행을 위한 쉘 스크립트
  - 사용법: `./run_complete_pipeline.sh "책 제목" [저자 이름]`

### 1984 영상 완성 및 업로드 ✅
- **영어 영상** (`1984_review_with_summary_en.mp4`)
  - 크기: 507.64 MB
  - 길이: 약 43분 21초
  - 구성: Summary + Review 오디오 연결
  - 썸네일: `1984_thumbnail_en.jpg` (206K)
  - YouTube URL: https://www.youtube.com/watch?v=cRd7BWQV4S8

- **한글 영상** (`1984_review_with_summary_ko.mp4`)
  - 크기: 232.28 MB
  - 길이: 약 19분 53초
  - 구성: Summary + Review 오디오 연결
  - 썸네일: `1984_thumbnail_ko.jpg` (201K)
  - YouTube URL: https://www.youtube.com/watch?v=_dhn1O7BWNs

### YouTube 업로드 완료
- 업로드된 책: 1984
- 업로드된 영상 수: 2개 (en, ko)
- 공개 설정: Private (비공개)
- 메타데이터: 자동 생성 및 저장 완료
- 썸네일: 자동 업로드 완료
- CSV 업데이트: `data/ildangbaek_books.csv`에 업로드 정보 반영

### 코드 개선
- 오디오 파일 자동 탐지 로직 개선 (summary/review, ko/en 구분)
- 메타데이터 생성 로직 통합
- 썸네일 경로 자동 연결 개선
- 전체 프로세스 자동화로 수동 작업 최소화

## 2025-11-25 (후반)

### 사피엔스 영상 생성 완료 ✅
- **한글 영상** (`사피엔스_review_with_summary_ko.mp4`)
  - 크기: 28MB
  - 길이: 약 19분 11초
  - 구성: 요약 (약 4분) + 3초 간격 + 리뷰 (약 15분)
  - 이미지: 100개 순환 반복
  - 썸네일: `사피엔스_thumbnail_ko.jpg` (153KB)
  - 메타데이터: `사피엔스_review_with_summary_ko.metadata.json`

- **영문 영상** (`사피엔스_review_with_summary_en.mp4`)
  - 크기: 144MB
  - 길이: 약 16분 28초
  - 구성: 요약 (약 4분) + 3초 간격 + 리뷰 (약 12분)
  - 이미지: 100개 순환 반복
  - 썸네일: `사피엔스_thumbnail_en.jpg` (159KB)
  - 메타데이터: `사피엔스_review_with_summary_en.metadata.json`
  - 오디오: `Harari_s_Sapiens_Big_History_Revolutions_en.m4a` 사용

### 썸네일 생성 개선 ✅
- **영어 폰트 깨짐 문제 해결**
  - 더 많은 폰트 경로 시도 (Arial Bold, Arial, Arial Black, Helvetica, Times New Roman 등)
  - TTC 파일 지원 (인덱스 지정)
  - 폰트 테스트로 정상 로드 확인

- **영문 썸네일 개선**
  - 영문 썸네일 생성 시 영어 제목과 영어 작가 이름 사용
  - `translate_book_title`, `translate_author_name` 함수 활용

- **작가/책 이미지 자동 검색 기능 추가**
  - Unsplash/Pexels에서 저작권 없는 이미지 자동 검색
  - 작가 이름 또는 책 제목으로 검색
  - 썸네일 배경으로 사용 (밝기 조정 및 블러 처리)
  - 기본값: `use_author_image=True` (자동 검색 활성화)
  - 이미지 우선순위: DALL-E > 제공된 배경 > 작가/책 이미지 > 그라데이션

### 영문 영상 생성 개선 ✅
- **영문 영상 생성 시 영어 제목/작가 사용**
  - 요약 생성 시 영어 제목("Sapiens")과 영어 작가 이름("Yuval Noah Harari") 사용
  - 메타데이터 생성 시에도 영어 제목/작가 사용
  - `src/10_create_video_with_summary.py` 수정

### 프로젝트 규칙 업데이트 ✅
- **`.cursorrules` 파일에 커밋 전 필수 작업 규칙 추가**
  - todo 파일 업데이트 필수
  - history 파일 업데이트 필수
  - README.md 업데이트 필수
  - 커밋 전 체크리스트 포함

### CSV 업데이트
- `data/ildangbaek_books.csv`에 사피엔스 추가
- Namuwiki에서 415개 책 추가
- 불필요한 항목 정리 (대학 필독서, 날짜 포함 항목 등)

## 2025-11-26

### YouTube 업로드 완료
- 업로드된 책: 소년이_온다_with_summary_en
- 업로드된 영상 수: 1개
- [1] [English] Human Acts Book Review | [영어] 소년이 온다 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=wuOMM7VENxQ

## 2025-11-27

### YouTube 업로드 완료
- 업로드된 책: 소년이_온다_with_summary_en
- 업로드된 영상 수: 1개
- [1] [English] Human Acts Book Review | [영어] 소년이 온다 책 리뷰 | Auto-Generated
  - URL: https://www.youtube.com/watch?v=8KWGWs1uyuw
